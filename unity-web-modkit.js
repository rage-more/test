(()=>{"use strict";var t,e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},h:()=>"38a6ca3a19810219ae3d",o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{KeyCode:()=>at,LogLevel:()=>t,Logger:()=>i,Runtime:()=>ft,ValueWrapper:()=>lt,version:()=>dt}),function(t){t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=4]="INFO",t[t.DEBUG=8]="DEBUG",t[t.MESSAGE=16]="MESSAGE",t[t.ALL=31]="ALL"}(t||(t={}));class i{constructor(t){this.name=t}error(...e){this.log(t.ERROR,...e)}warn(...e){this.log(t.WARN,...e)}info(...e){this.log(t.INFO,...e)}debug(...e){this.log(t.DEBUG,...e)}message(...e){this.log(t.MESSAGE,...e)}log(e,...n){if(this.shouldLog(e)&&n.length>0){const i=`%c[${this.name}] %c[${t[e]}]%c`;let o=n.shift();"string"!=typeof o?(n.push(o),o=""):o=" "+o;let s,r="color: #fff;";switch(e){case t.ERROR:s="color: #FF6E74;";break;case t.WARN:s="color: #FFB36A;";break;case t.INFO:s="color: #35EA93;";break;case t.DEBUG:s="color: #BE7CFF;";break;case t.MESSAGE:s="color: #56C4FF;"}console.log(i+o,r,s,"color: default;",...n)}}shouldLog(e){return t.DEBUG,!0}}class o extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,new.target.prototype)}print(){return this.name+": "+this.message}}class s extends o{constructor(){super(...arguments),this.name="UnresolvedMetadataError"}}class r extends o{constructor(){super(...arguments),this.name="MetadataParsingError"}}function a(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((i=i.apply(t,e||[])).next())}))}function c(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,s=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r}function l(t,e,n){if(n||2===arguments.length)for(var i,o=0,s=e.length;o<s;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}var f,d={withStackTrace:!1},h=function(t,e,n){return void 0===n&&(n=d),{data:e.isOk()?{type:"Ok",value:e.value}:{type:"Err",value:e.error},message:t,stack:n.withStackTrace?(new Error).stack:void 0}},y=function(){function t(t){this._promise=t}return t.fromSafePromise=function(e){return new t(e.then((function(t){return new _(t)})))},t.fromPromise=function(e,n){return new t(e.then((function(t){return new _(t)})).catch((function(t){return new v(n(t))})))},t.combine=function(t){return g(t)},t.combineWithAllErrors=function(t){return m(t)},t.prototype.map=function(e){var n=this;return new t(this._promise.then((function(t){return a(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return t.isErr()?[2,new v(t.error)]:(n=_.bind,[4,e(t.value)]);case 1:return[2,new(n.apply(_,[void 0,i.sent()]))]}}))}))})))},t.prototype.mapErr=function(e){var n=this;return new t(this._promise.then((function(t){return a(n,void 0,void 0,(function(){var n;return c(this,(function(i){switch(i.label){case 0:return t.isOk()?[2,new _(t.value)]:(n=v.bind,[4,e(t.error)]);case 1:return[2,new(n.apply(v,[void 0,i.sent()]))]}}))}))})))},t.prototype.andThen=function(e){return new t(this._promise.then((function(n){if(n.isErr())return new v(n.error);var i=e(n.value);return i instanceof t?i._promise:i})))},t.prototype.orElse=function(e){var n=this;return new t(this._promise.then((function(t){return a(n,void 0,void 0,(function(){return c(this,(function(n){return t.isErr()?[2,e(t.error)]:[2,new _(t.value)]}))}))})))},t.prototype.match=function(t,e){return this._promise.then((function(n){return n.match(t,e)}))},t.prototype.unwrapOr=function(t){return this._promise.then((function(e){return e.unwrapOr(t)}))},t.prototype.then=function(t,e){return this._promise.then(t,e)},t}(),p=function(t){return new y(Promise.resolve(new v(t)))},B=(y.fromPromise,y.fromSafePromise,function(t){return t.reduce((function(t,e){return t.isOk()?e.isErr()?b(e.error):t.map((n=e.value,function(t){return l(l([],u(t),!1),[n],!1)})):t;var n}),w([]))}),g=function(t){return y.fromSafePromise(Promise.all(t)).andThen(B)},k=function(t){return t.reduce((function(t,e){return e.isErr()?t.isErr()?b(l(l([],u(t.error),!1),[e.error],!1)):b([e.error]):t.isErr()?t:w(l(l([],u(t.value),!1),[e.value],!1))}),w([]))},m=function(t){return y.fromSafePromise(Promise.all(t)).andThen(k)};!function(t){t.fromThrowable=function(t,e){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{var o=t.apply(void 0,l([],u(n),!1));return w(o)}catch(t){return b(e?e(t):t)}}},t.combine=function(t){return B(t)},t.combineWithAllErrors=function(t){return k(t)}}(f||(f={}));var w=function(t){return new _(t)},b=function(t){return new v(t)},_=function(){function t(t){this.value=t}return t.prototype.isOk=function(){return!0},t.prototype.isErr=function(){return!this.isOk()},t.prototype.map=function(t){return w(t(this.value))},t.prototype.mapErr=function(t){return w(this.value)},t.prototype.andThen=function(t){return t(this.value)},t.prototype.orElse=function(t){return w(this.value)},t.prototype.asyncAndThen=function(t){return t(this.value)},t.prototype.asyncMap=function(t){return y.fromSafePromise(t(this.value))},t.prototype.unwrapOr=function(t){return this.value},t.prototype.match=function(t,e){return t(this.value)},t.prototype._unsafeUnwrap=function(t){return this.value},t.prototype._unsafeUnwrapErr=function(t){throw h("Called `_unsafeUnwrapErr` on an Ok",this,t)},t}(),v=function(){function t(t){this.error=t}return t.prototype.isOk=function(){return!1},t.prototype.isErr=function(){return!this.isOk()},t.prototype.map=function(t){return b(this.error)},t.prototype.mapErr=function(t){return b(t(this.error))},t.prototype.andThen=function(t){return b(this.error)},t.prototype.orElse=function(t){return t(this.error)},t.prototype.asyncAndThen=function(t){return p(this.error)},t.prototype.asyncMap=function(t){return p(this.error)},t.prototype.unwrapOr=function(t){return t},t.prototype.match=function(t,e){return e(this.error)},t.prototype._unsafeUnwrap=function(t){throw h("Called `_unsafeUnwrap` on an Err",this,t)},t.prototype._unsafeUnwrapErr=function(t){return this.error},t}();f.fromThrowable;class J{constructor(t,e=!0){this._view=new DataView(t),this._buffer=t,this._offset=0,this._littleEndian=e,this._utf8decoder=new TextDecoder("utf-8")}get offset(){return this._offset}get buffer(){return this._buffer}seek(t){this._offset=t}readNullTerminatedUTF8String(){const t=this._offset;for(;0!==this._view.getUint8(this._offset++););return this._utf8decoder.decode(this._view.buffer.slice(t,this._offset-1))}readUTF8StringWithLength(){const t=this.readUint32(),e=this._utf8decoder.decode(this._view.buffer.slice(this._offset,this._offset+t));return this._offset+=t,e}readUint8(){const t=this._view.getUint8(this._offset);return this._offset++,t}readUint16(){const t=this._view.getUint16(this._offset,this._littleEndian);return this._offset+=2,t}readInt32(){const t=this._view.getInt32(this._offset,this._littleEndian);return this._offset+=4,t}readUint32(){const t=this._view.getUint32(this._offset,this._littleEndian);return this._offset+=4,t}readFloat(){const t=this._view.getFloat32(this._offset,this._littleEndian);return this._offset+=4,t}readULEB128(){let t,e=0,n=0;do{t=this.readUint8(),e|=(127&t)<<n,n+=7}while(128&t);return e}readUint8Array(t){const e=this.readSlice(this.offset,t);return this._offset+=t,new Uint8Array(e)}readSlice(t,e){return this._view.buffer.slice(t,t+e)}}class U{constructor(t,e=!0){this._view=new DataView(t),this._offset=0,this._littleEndian=e}seek(t){if(!(t>=0&&t<this._view.byteLength))throw new Error("Invalid offset value.");this._offset=t}writeUint8(t){if(!(this._offset<this._view.byteLength))throw new Error("Buffer overflow: Cannot write beyond the ArrayBuffer length.");this._view.setUint8(this._offset,t),this._offset+=1}writeInt32(t){if(!(this._offset<this._view.byteLength))throw new Error("Buffer overflow: Cannot write beyond the ArrayBuffer length.");this._view.setInt32(this._offset,t,this._littleEndian),this._offset+=4}writeUint32(t){if(!(this._offset<this._view.byteLength))throw new Error("Buffer overflow: Cannot write beyond the ArrayBuffer length.");this._view.setUint32(this._offset,t,this._littleEndian),this._offset+=4}writeFloat(t){if(!(this._offset<this._view.byteLength))throw new Error("Buffer overflow: Cannot write beyond the ArrayBuffer length.");this._view.setFloat32(this._offset,t,this._littleEndian),this._offset+=4}writeBytes(t){const e=new Uint8Array(t),n=this._view.byteLength-this._offset,i=e.length;if(!(i<=n))throw new Error("Buffer overflow: Cannot write beyond the ArrayBuffer length.");for(let t=0;t<i;t++)this._view.setUint8(this._offset,e[t]),this._offset++}finalize(){return new Uint8Array(this._view.buffer)}}function E(t){let e="";for(let n=0;n<t;n++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return e}function I(t,e){const n=[];if(0===e.length)return n;const i=function(t){const e=[];e[0]=0;let n=0,i=1;for(;i<t.length;)t[i]===t[n]?(n++,e[i]=n,i++):0!==n?n=e[n-1]:(e[i]=0,i++);return e}(e);let o=0,s=0;for(;o<t.length;)t[o]===e[s]&&(o++,s++),s===e.length?(n.push(o-s),s=i[s-1]):o<t.length&&t[o]!==e[s]&&(0!==s?s=i[s-1]:o++);return n}function S(t,e,n){if(n+e.length>t.length)throw new Error("Source array does not fit at the specified offset in the destination array.");for(let i=0;i<e.length;i++)t[n+i]=e[i]}function x(t,e,n){return t.seek(e+n),t.readNullTerminatedUTF8String()}function C(t,e,n){for(const i of t){let t=88*i.typeStart+e,o=88*i.typeCount;if(n>=t&&n<t+o)return!0}return!1}function A(t,e){return t.seek(e),{moduleName:t.readUint32(),methodPointerCount:t.readInt32(),methodPointers:t.readUint32(),adjustorThunkCount:t.readInt32(),adjustorThunks:t.readUint32(),invokerIndices:t.readUint32(),reversePInvokeWrapperCount:t.readUint32(),reversePInvokeWrapperIndices:t.readUint32(),rgctxRangesCount:t.readInt32(),rgctxRanges:t.readUint32(),rgctxsCount:t.readInt32(),rgctxs:t.readUint32(),debuggerMetadata:t.readUint32(),moduleInitializer:t.readUint32(),staticConstructorTypeIndices:t.readUint32(),metadataRegistration:t.readUint32(),codeRegistration:t.readUint32()}}function P(t,e,n){t.seek(e);const i=[];for(let e=0;e<n;e++)i.push(t.readUint32());return i}class F{constructor(t,e){this.exec=[],this.data=[],this.bss=[],this.memoryReader=new J(t),this.imageCount=e}setExecSection(t){this.exec.push(t)}setDataSection(t){this.data.push(t)}setBssSection(t){this.bss.push(t)}findCodeRegistration(){return this.findCodeRegistrationData()}findCodeRegistrationData(){return this.findCodeRegistration2019(this.data)}findCodeRegistration2019(t){for(let e=0;e<t.length;e++){const n=t[e];this.memoryReader.seek(n.offset);const i=I(this.memoryReader.readUint8Array(n.offsetEnd-n.offset),F.featureBytes);for(let t=0;t<i.length;t++){const e=i[t]+n.address,o=this.findReference(e);for(let t=0;t<o.length;t++){const e=o[t],n=this.findReference(e);for(let t=0;t<n.length;t++){const e=n[t];for(let t=this.imageCount-1;t>=0;t--){const n=this.findReference(e-4*t);for(let t=0;t<n.length;t++){const e=n[t];if(this.memoryReader.seek(e-4),this.memoryReader.readInt32()===this.imageCount)return e-56}}}}}}return 0}findReference(t){const e=[];for(let i=0;i<this.data.length;i++){const o=this.data[i];var n=o.offset;const s=Math.min(o.offsetEnd,this.memoryReader.buffer.byteLength)-4;for(;n<s;)this.memoryReader.seek(n),this.memoryReader.readUint32()===t&&e.push(n-o.offset+o.address),n+=4}return e}}F.featureBytes=new Uint8Array([109,115,99,111,114,108,105,98,46,100,108,108,0]);class T{constructor(t,e){var n;this.nodes=[];const i=new J(t);for(this.signature=i.readNullTerminatedUTF8String(),this.headLen=i.readUint32();i.offset<this.headLen;){const t={offset:i.readUint32(),size:i.readUint32(),name:i.readUTF8StringWithLength()},o=null==e?void 0:e.find((e=>e[0]===t.name));o&&(t.size=null!==(n=o[1])&&void 0!==n?n:t.size,this.nodes.push(t))}for(const t of this.nodes)t.data=i.readSlice(t.offset,t.size);this.resolveUnityVersion(i)}getNode(t){return this.nodes.find((e=>e.name===t))}resolveUnityVersion(t){const e=this.getNode("data.unity3d");if(!e||!e.data)return;const n=new J(e.data);n.seek(18),this.unityVersion=n.readNullTerminatedUTF8String()}}var O=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((i=i.apply(t,e||[])).next())}))};const M=new i("Preloader");function V(){return O(this,void 0,void 0,(function*(){return M.debug("Nothing in indexedDB cache, resorting to hooking Fetch API"),new Promise((t=>{const e=window.fetch;window.fetch=function(n){return O(this,arguments,void 0,(function*(){if(n.includes("webgl.data.br")){window.fetch=e;const n=yield e.apply(this,arguments);return t(R(yield n.clone().arrayBuffer())),n}return e.apply(this,arguments)}))}}))}))}function R(t){return new T(t,[["data.unity3d",32],["Il2CppData/Metadata/global-metadata.dat"]])}const D={func:0,table:1,memory:2,global:3};Object.entries(D).forEach((([t,e])=>D[e]=t));const W=function(t){const e=D[t];if(void 0===e)throw new Error("Invalid kind "+t);return e},N={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,block:64};Object.entries(N).forEach((([t,e])=>N[e]=t));const L=function(t){const e=N[t];if(void 0===e)throw new Error("Invalid value type "+t);return e},z=11,G=function(t){const e=opcodeStr[t];if(void 0===e)throw new Error("Invalid opcode "+t);return e},K=function(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n];let o=i;"string"==typeof i&&(o=G(i)),e.push(o)}return e},j=function(t){return[255&t]},q=function(t){return[255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24]},H=function(t){return[255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24,(0xff00000000&t)>>32,(0xff0000000000&t)>>40,(0xff000000000000&t)>>48,(0xff00000000000000&t)>>56]},$=function(t){const e=[];let n=t;if(0==t)return[0];for(;n>0;){let t=127&n;n>>=7,n&&(t|=128),e.push(t)}return e},Q=function(t){return t.split("").map((function(t){return t.charCodeAt(0)}))},Y=function(t){return"number"==typeof t?$(t):t instanceof X?t.varUint32():void 0};class X{constructor(){this._value=null}get value(){if(null===this._value)throw new Error("Attempted to resolve WailVariable before set");return this._value}set value(t){this._value=t}i32(){return null!==this._value?this.value:new tt(this)}f32(){if(null!==this._value){const t=new Float32Array([this._value]);return new Uint8Array(t.buffer)}return new et(this)}i64(){return null!==this._value?this.value:new nt(this)}f64(){if(null!==this._value){const t=new Float64Array([this._value]);return new Uint8Array(t.buffer)}return new it(this)}varUint32(){return null!==this._value?Y(this.value):new ot(this)}}class Z{constructor(t){this._parent=t}}class tt extends Z{get value(){return q(this._parent.value)}}class et extends Z{get value(){return q(this._parent.value)}}class nt extends Z{get value(){return H(this._parent.value)}}class it extends Z{get value(){return H(this._parent.value)}}class ot extends Z{get value(){return $(this._parent.value)}}const st=class{constructor(t){this.inBuffer=null,this.outBuffer=null,void 0!==t?(this.inBuffer=new Uint8Array(t),this.outBuffer=new Uint8Array(2*t.length)):this.outBuffer=new Uint8Array(1),this.inPos=0,this._copyPos=0,this.outPos=0,this._anchor=null}load(t){this.inBuffer=new Uint8Array(t),this.outBuffer=new Uint8Array(2*this.inBuffer.length)}resize(){if(0==this.outBuffer.length)throw new Error("Attempted to resize 0-length buffer");const t=new Uint8Array(Math.ceil(1.25*this.outBuffer.length));for(let e=0;e<this.outPos;e++)t[e]=this.outBuffer[e];this.outBuffer=t}readUint8(){return this.inBuffer[this.inPos++]}readUint32(){return this.inBuffer[this.inPos++]|this.inBuffer[this.inPos++]<<8|this.inBuffer[this.inPos++]<<16|this.inBuffer[this.inPos++]<<24}readVarUint32(){let t,e=0,n=0;do{t=this.readUint8(),e|=(127&t)<<n,n+=7}while(128&t);return e}readUint64(){return this.inBuffer[this.inPos++]|this.inBuffer[this.inPos++]<<8|this.inBuffer[this.inPos++]<<16|this.inBuffer[this.inPos++]<<24|this.inBuffer[this.inPos++]<<32|this.inBuffer[this.inPos++]<<40|this.inBuffer[this.inPos++]<<48|this.inBuffer[this.inPos++]<<56}readUint128(){return this.inBuffer[this.inPos++]|this.inBuffer[this.inPos++]<<8|this.inBuffer[this.inPos++]<<16|this.inBuffer[this.inPos++]<<24|this.inBuffer[this.inPos++]<<32|this.inBuffer[this.inPos++]<<40|this.inBuffer[this.inPos++]<<48|this.inBuffer[this.inPos++]<<56|this.inBuffer[this.inPos++]<<64|this.inBuffer[this.inPos++]<<72|this.inBuffer[this.inPos++]<<80|this.inBuffer[this.inPos++]<<88|this.inBuffer[this.inPos++]<<96|this.inBuffer[this.inPos++]<<104|this.inBuffer[this.inPos++]<<112|this.inBuffer[this.inPos++]<<120}readBytes(t){const e=new Uint8Array(t);for(let n=0;n<t;n++)e[n]=this.inBuffer[this.inPos++];return e}copyBuffer(t){for(;t.length+this.outPos>this.outBuffer.length;)this.resize();for(let e=0;e<t.length;e++,this.outPos++)this.outBuffer[this.outPos]=t[e];this.updateCopyPosition()}commitBytes(){for(;this.inPos-this._copyPos+this.outPos>this.outBuffer.length;)this.resize();for(;this._copyPos<this.inPos;this._copyPos++,this.outPos++)this.outBuffer[this.outPos]=this.inBuffer[this._copyPos]}updateCopyPosition(){this._copyPos=this.inPos}setAnchor(){this._anchor=this.outPos}readFromAnchor(){return this.outBuffer.slice(this._anchor,this.outPos)}writeAtAnchor(t){for(;t.length+this.outPos>this.outBuffer.length;)this.resize();for(let e=0;e<t.length;e++)this.outBuffer[this._anchor+e]=t[e];this.outPos=this._anchor+t.length}write(){return this.outBuffer.slice(0,this.outPos)}};class rt extends st{constructor(t){super(t),this._finished=!1,this._newSections=[],this._removeSectionIds=[],this._resolvedTables=!1,this._importFuncCount=0,this._importFuncNewCount=0,this._importGlobalCount=0,this._importGlobalNewCount=0,this._globalImportCallback=null,this._importCallbacks=[],this._globalExportCallback=null,this._exportCallbacks=[],this._globalFunctionCallback=null,this._functionCallbacks=[],this._globalInstructionCallback=null,this._instructionCallbacks={},this._sectionOptions={};for(let t=0;t<=12;t++)this._sectionOptions[t]={newEntries:[],existingEntries:[],pending:[]};this._requiredSectionFlags=0,this._optionalSectionFlags=0,this._parsedSections=0,this.__variables=[]}parse(){const t=this.readUint32();if(this.readUint32(),1836278016!=t)throw new Error("Invalid magic. Probably not a WebAssembly binary");for(;this.inPos<this.inBuffer.length;)this._readSection();this.commitBytes(),this._finished=!0}removeSection(t){if("number"!=typeof t)throw new Error("Invalid argument to removeSection()");this._removeSectionIds.push(t)}addTypeEntry(t){const e={},n=t.form;e.form="number"==typeof n?n:L(n);const i=t.params;if(i instanceof Array){const t=[];for(let e=0;e<i.length;e++){const n=i[e];"number"==typeof n?t.push(n):t.push(L(n))}e.params=t}else e.params=[];const o=t.returnType;"number"==typeof o?e.returnType=o:"string"==typeof o&&(e.returnType=L(o));const s=this._createVariable();return e.variable=s,this._sectionOptions[1].newEntries.push(e),this._requiredSectionFlags|=2,s}editTypeEntry(t,e){const n={};if("number"!=typeof t)throw new Error("Invalid index in editTypeEntry()");n.index=t;const i=e.params;n.params=i instanceof Array?i:[];const o=e.returnType;o&&(n.returnType=o),this._sectionOptions[1].existingEntries.push(n),this._optionalSectionFlags|=2}addImportEntry(t){const e={},n=t.moduleStr;if(!("string"==typeof n||n instanceof String))throw new Error("Invalid moduleStr");e.moduleStr=n;const i=t.fieldStr;if(!("string"==typeof i||i instanceof String))throw new Error("Invalid fieldStr");e.fieldStr=i;const o=t.kind;let s;s="number"==typeof o?o:W(o);let r=t.type;switch(e.kind=s,s){case 0:if(this._importFuncNewCount++,"number"==typeof r)e.type=r;else if(r instanceof ot)e.type=r;else{if(!(r instanceof X))throw new Error("Invalid type");e.type=r.varUint32()}break;case 3:if(this._importGlobalNewCount++,"number"!=typeof r)throw new Error("Invalid type");if(e.type=r,0!==t.mutability&&1!==t.mutability&&!0!==t.mutability&&!1!==t.mutability)throw new Error("Invalid mutability");e.mutability=t.mutability;break;case 2:throw new Error("Adding new memory object not currently supported");case 1:throw new Error("Adding new table object not currently supported");default:throw new Error("Invalid kind")}const a=this._createVariable();return e.variable=a,this._sectionOptions[2].newEntries.push(e),this._requiredSectionFlags|=4,this._importFuncNewCount>0&&(this._optionalSectionFlags|=128,this._optionalSectionFlags|=512,this._optionalSectionFlags|=1024,this._optionalSectionFlags|=256),this._importGlobalNewCount>0&&(this._optionalSectionFlags|=128,this._optionalSectionFlags|=1024),a}editImportEntry(t,e){const n={};if(n.index=t,"number"!=typeof t&&!(t instanceof X))throw new Error("Invalid index in editImportEntry()");const i=e.moduleStr;("string"==typeof i||i instanceof String)&&(n.moduleStr=Q(i));const o=e.fieldStr;("string"==typeof o||o instanceof String)&&(n.fieldStr=Q(o)),this._sectionOptions[2].existingEntries.push(n),this._optionalSectionFlags|=4}addImportElementParser(t,e){if("function"!=typeof e)throw new Error("Bad callback in addImportElementParser()");if(null===t)this._globalImportCallback=e;else{if(!("number"==typeof t||t instanceof X))throw new Error("Bad id "+t+" in addImportElementParser()");{const n={};n.index=t,n.callback=e,this._importCallbacks.push(n)}}this._optionalSectionFlags|=4}addFunctionEntry(t){const e={},n=t.type;if("number"==typeof n)e.type=n;else if(n instanceof ot)e.type=n;else{if(!(n instanceof X))throw new Error("Invalid type");e.type=n.varUint32()}const i=this._createVariable();return e.variable=i,this._sectionOptions[3].newEntries.push(e),this._requiredSectionFlags|=8,i}editFunctionEntry(t,e){const n={};if(n.index=t,"number"!=typeof t&&!(t instanceof X))throw new Error("Invalid index in editFunctionEntry()");const i=e.type;if("number"!=typeof i)throw new Error("Invalid type in editFunctionEntry()");n.type=i,this._sectionOptions[3].existingEntries.push(n),this._optionalSectionFlags|=8}getFunctionIndex(t){if(this._finished){if(t instanceof X)return t;{const e=this._createVariable();return e.value=this._getAdjustedFunctionIndex(t),e}}const e=this._createVariable();if("number"!=typeof t)throw new Error("Invalid index in getFunctionIndex()");const n={oldIndex:t,variable:e};return this._sectionOptions[3].pending.push(n),this._optionalSectionFlags|=4,e}addGlobalEntry(t){const e={globalType:{}};if(void 0===t.globalType)throw new Error("Invalid globalType");"number"==typeof t.globalType.contentType?e.globalType.contentType=t.globalType.contentType:e.globalType.contentType=L(t.globalType.contentType);const n=t.globalType.mutability;if(1==n)e.globalType.mutability=1;else{if(0!=n)throw new Error("Invalid mutability");e.globalType.mutability=0}t.initExpr instanceof Array?e.initExpr=K(t.initExpr):e.initExpr=[65,Y(0),z];const i=this._createVariable();return e.variable=i,this._sectionOptions[6].newEntries.push(e),this._requiredSectionFlags|=64,i}editGlobalEntry(t,e){const n={};if("number"==typeof t)console.warn("Using raw indexes in editGlobalEntry() can have unpredictable results. Consider using getGlobalIndex() instead");else if(!(t instanceof X))throw new Error("Invalid globalIndex in addCodeEntry()");if(n.index=t,n.globalType={},void 0===e.globalType)throw new Error("Invalid globalType");"number"==typeof e.globalType.contentType?n.globalType.contentType=e.globalType.contentType:n.globalType.contentType=L(e.globalType.contentType);const i=e.globalType.mutability;if(1==i)n.globalType.mutability=1;else{if(0!=i)throw new Error("Invalid mutability");n.globalType.mutability=0}this._sectionOptions[6].existingEntries.push(n),this._requiredSectionFlags|=64}getGlobalIndex(t){if(this._finished)return t instanceof X?t.value:this._getAdjustedGlobalIndex(t);const e=this._createVariable();if("number"!=typeof t)throw new Error("Invalid index in getGlobalIndex()");const n={oldIndex:t,variable:e};return this._sectionOptions[6].pending.push(n),this._optionalSectionFlags|=4,e}addExportEntry(t,e){const n={};if(!("string"==typeof e.fieldStr||e.fieldStr instanceof String))throw new Error("Invalid fieldStr");if(n.fieldStr=e.fieldStr,"number"==typeof e.kind?n.kind=e.kind:n.kind=W(e.kind),"number"==typeof t)n.index=t;else if(t instanceof ot)n.index=t;else{if(!(t instanceof X))throw new Error("Invalid type");n.index=t.varUint32()}const i=this._createVariable();return n.variable=i,this._sectionOptions[7].newEntries.push(n),this._requiredSectionFlags|=128,i}editExportEntry(t,e){const n={};if(n.index=t,"number"!=typeof t&&!(t instanceof X))throw new Error("Invalid index in editExportEntry()");const i=e.fieldStr;("string"==typeof i||i instanceof String)&&(n.fieldStr=Q(i)),n.kind=e.kind,n.funcIndex=e.index,this._sectionOptions[7].existingEntries.push(n),this._optionalSectionFlags|=128}addExportElementParser(t,e){if("function"!=typeof e)throw new Error("Bad callback in addExportElementParser()");if(null===t)this._globalExportCallback=e;else{if(!("number"==typeof t||t instanceof X))throw new Error("Bad id "+t+" in addExportElementParser()");{const n={};n.index=t,n.callback=e,this._exportCallbacks.push(n)}}this._optionalSectionFlags|=128}editStartEntry(t){if("number"!=typeof t&&!(t instanceof X))throw new Error("Invalid index in editStartEntry()");this._sectionOptions[8].existingEntries.push(t),this._requiredSectionFlags|=256}addElementEntry(t){const e=this._createVariable();return t.variable=e,this._sectionOptions[9].newEntries.push(t),this._requiredSectionFlags|=512,e}editElementEntry(t,e){const n={};if(n.index=t,"number"!=typeof t&&!(t instanceof X))throw new Error("Invalid index in editElementEntry()");n.elems=[],this._sectionOptions[9].existingEntries.push(n),this._optionalSectionFlags|=512}addCodeEntry(t,e){const n={};if("number"==typeof t)console.warn("Using raw indexes in addCodeEntry() can have unpredictable results. Consider using getFunctionIndex() instead");else if(!(t instanceof X))throw new Error("Invalid funcIndex in addCodeEntry()");n.index=t;const i=e.locals;if(i instanceof Array){const t=[];for(let e=0;e<i.length;e++){const n=i[e];if("number"==typeof n)t.push(n);else{if("string"!=typeof n)throw new Error("Invalid local entry in addCodeEntry()");t.push(L(n))}}n.locals=t}else n.locals=[];const o=e.code;if(!(o instanceof Array))throw new Error("Invalid code");n.code=K(o);const s=this._createVariable();return n.variable=s,this._sectionOptions[10].newEntries.push(n),this._requiredSectionFlags|=1024,s}editCodeEntry(t,e){const n={};if("number"==typeof t)console.warn("Using raw indexes in editCodeEntry() can have unpredictable results. Consider using getFunctionIndex() instead");else if(!(t instanceof X))throw new Error("Invalid funcIndex in addCodeEntry()");n.index=t;const i=e.locals;if(i instanceof Array){const t=[];for(let e=0;e<i.length;e++){const n=i[e];if("number"==typeof n)t.push(n);else{if("string"!=typeof n)throw new Error("Invalid local entry in addCodeEntry()");t.push(L(n))}}n.locals=t}else n.locals=[];const o=e.code;if(!(o instanceof Array))throw new Error("Invalid code");n.code=K(o),this._sectionOptions[10].existingEntries.push(n),this._optionalSectionFlags|=4,this._optionalSectionFlags|=1024}addDataEntry(t){const e=this._createVariable();return t.variable=e,this._sectionOptions[11].newEntries.push(t),this._requiredSectionFlags|=2048,e}editDataEntry(t,e){const n={};if("number"!=typeof t)throw new Error("Invalid index in editTypeEntry()");n.index=t,"string"==typeof e.data?n.data=Q(e.data):n.data=e.data,this._sectionOptions[11].existingEntries.push(n),this._optionalSectionFlags|=2048}addCodeElementParser(t,e){if("function"!=typeof e)throw new Error("Bad callback in addCodeElementParser()");if(null===t)this._globalFunctionCallback=e;else{if(!("number"==typeof t||t instanceof X))throw new Error("Bad id "+t+" in addCodeElementParser()");{const n={};n.index=t,n.callback=e,this._functionCallbacks.push(n)}}this._optionalSectionFlags|=4,this._optionalSectionFlags|=1024}addInstructionParser(t,e){if("function"!=typeof e)throw new Error("Bad callback in addInstructionParser()");if(null===t)this._globalInstructionCallback=e;else{if(isNaN(t)&&!(t instanceof X))throw new Error("Bad opcode "+t+" in addCodeElementParser()");this._instructionCallbacks[t]=e}this._optionalSectionFlags|=1024}addRawSection(t,e){const n={};if("number"!=typeof t)throw new Error("Bad section index "+index+" in addRawSection()");n.id=t,n.bytes=e,this._newSections.push(n)}_createVariable(){const t=this.__variables.length,e=new X(this,t);return this.__variables.push(e),e}_getVariable(t){return this.__variables[t]}_setVariable(t,e){this.__variables[t]=e}_expandArrayVariables(t){for(let e=0;e<t.length;e++){const n=t[e];if(n instanceof Array)t.splice(e,1),t.splice(e,0,...n);else if(n instanceof Z){const i=n;t.splice(e,1),t.splice(e,0,...i.value)}else if(n instanceof X)throw new Error("Untyped WailVariable in _expandArrayVariables()")}return t}_readSection(){this.commitBytes();const t=this.readUint8();if(t>12)throw new Error("Illegal section ID "+t+". Probably parsing incorrectly");let e;if(this._removeSectionIds.includes(t))return e=this.readVarUint32(),this.readBytes(e),void this.updateCopyPosition();let n=!1;if((this._requiredSectionFlags&1<<t||this._optionalSectionFlags&1<<t)&&(n=!0),12!=t)for(let e=0;e<t;e++){const n=1<<e,i=this._requiredSectionFlags&n;if(i&&!(i&this._parsedSections)){switch(e){case 1:this._addTypeSection();break;case 2:this._addImportSection();break;case 3:this._addFunctionSection();break;case 6:this._addGlobalSection();break;case 7:this._addExportSection();break;case 8:this._addStartSection();break;case 9:this._addElementSection();break;case 10:this._addCodeSection();break;case 11:this._addDataSection();break;default:throw new Error("Attempted to add unhandled section")}this._parsedSections|=n,this.copyBuffer([t])}}for(let e=0;e<this._newSections.length;e++){const n=this._newSections[e];if(t>n.id){const t=n.bytes,e=$(t.length);this.copyBuffer([n.id]),this.copyBuffer(e),this.copyBuffer(t)}}if(!n)return e=this.readVarUint32(),void this.readBytes(e);switch(t>2&&0==this._resolvedTables&&this._resolveTableIndices(),t){case 1:this._parseTypeSection();break;case 2:this._parseImportSection();break;case 3:this._parseFunctionSection();break;case 6:this._parseGlobalSection();break;case 7:this._parseExportSection();break;case 8:this._parseStartSection();break;case 9:this._parseElementSection();break;case 10:this._parseCodeSection();break;case 11:this._parseDataSection();break;default:throw new Error("Attempted to parse unhandled section")}this._parsedSections|=1<<t}_resolveTableIndices(){const t=this._sectionOptions[3].pending;for(let e=0;e<t.length;e++){const n=t[e].oldIndex;t[e].variable.value=this._getAdjustedFunctionIndex(n)}const e=this._sectionOptions[6].pending;for(let t=0;t<e.length;t++){const n=e[t].oldIndex;e[t].variable.value=this._getAdjustedGlobalIndex(n)}this._resolvedTables=!0}_addTypeSection(){const t=new st,e=this._sectionOptions[1].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++){const i=e[n],o=i.form,s=i.params;let r=null;void 0!==i.returnType&&(r=i.returnType),i.variable instanceof X&&(i.variable.value=oldCount+n),t.copyBuffer(j(o)),t.copyBuffer($(s.length)),t.copyBuffer(s),null!==r?(t.copyBuffer(j(1)),t.copyBuffer(j(r))):t.copyBuffer(j(0))}const i=t.write(),o=$(i.length);this.copyBuffer([1]),this.copyBuffer(o),this.copyBuffer(i)}_parseTypeSection(){this.commitBytes();const t=this.readVarUint32(),e=this.inPos,n=this.readVarUint32(),i=this.inPos-e,o=this.readBytes(t-i),s=new st(o),r=this._sectionOptions[1].newEntries,a=this._sectionOptions[1].existingEntries,c=n+r.length;let u=!1;window.UnityWebModkit.Runtime&&window.UnityWebModkit.Runtime.internalWasmTypes||(u=!0,window.UnityWebModkit.Runtime.internalWasmTypes=[]),s.copyBuffer($(c));for(let t=0;t<n;t++){const e=s.readUint8();let n=s.readVarUint32(),i=[];for(let t=0;t<n;t++)i.push(s.readUint8());let o=s.readUint8(),r=null;if(1==o)r=s.readUint8();else if(0!=o)throw new Error("Invalid returnCount");for(let e=0;e<a.length;e++){const n=a[e];t==n.index&&(void 0!==n.params&&(i=mod.params),void 0!==n.returnType&&(o=1,r=mod.returnType))}s.copyBuffer(j(e)),s.copyBuffer($(i.length)),s.copyBuffer(i),o?(s.copyBuffer(j(1)),s.copyBuffer(j(r))):s.copyBuffer(j(0)),u&&window.UnityWebModkit.Runtime.internalWasmTypes.push({form:N[e],params:i.map((t=>N[t])),returnType:N[r]})}for(let t=0;t<r.length;t++){const e=r[t],i=e.form,o=e.params;let a=null;void 0!==e.returnType&&(a=e.returnType),e.variable instanceof X&&(e.variable.value=n+t),s.copyBuffer(j(i)),s.copyBuffer($(o.length)),s.copyBuffer(o),null!==a?(s.copyBuffer(j(1)),s.copyBuffer(j(a))):s.copyBuffer(j(0))}const l=s.write(),f=$(l.length);this.copyBuffer(f),this.copyBuffer(l)}_addImportSection(){const t=new st,e=this._sectionOptions[2].newEntries,n=$(e.length);t.copyBuffer(n);let i=0,o=0;for(let n=0;n<e.length;n++){const s=e[n],r=Q(s.moduleStr),a=$(r.length),c=Q(s.fieldStr),u=$(c.length),l=[s.kind];let f;if(0==s.kind){if(s.type instanceof Z)f=s.type.value;else{if(s.type instanceof X)throw new Error("Untyped WailVariable in _addImportSection()");f=$(s.type)}s.variable instanceof X&&(s.variable.value=this._importFuncCount+i++)}else 3==s.kind&&(f=[s.type,s.mutability],s.variable instanceof X&&(s.variable.value=this._importGlobalCount+o++));t.copyBuffer(a),t.copyBuffer(r),t.copyBuffer(u),t.copyBuffer(c),t.copyBuffer(l),t.copyBuffer(f)}const s=t.write(),r=$(s.length);this.copyBuffer([2]),this.copyBuffer(r),this.copyBuffer(s);const a=this._sectionOptions[3].pending;for(let t=0;t<a.length;t++){const e=a[t].oldIndex;a[t].variable.value=this._getAdjustedFunctionIndex(e)}const c=this._sectionOptions[6].pending;for(let t=0;t<c.length;t++){const e=c[t].oldIndex;c[t].variable.value=this._getAdjustedGlobalIndex(e)}}_parseImportSection(){this.commitBytes();const t=this.readVarUint32(),e=this.inPos,n=this.readVarUint32(),i=this.inPos-e,o=this.readBytes(t-i),s=new st(o),r=this._sectionOptions[2].newEntries,a=this._sectionOptions[2].existingEntries;for(let t=0;t<n;t++){s.commitBytes();let e=s.readVarUint32(),n=s.readBytes(e),i=s.readVarUint32(),o=s.readBytes(i);for(let s=0;s<a.length;s++){const r=a[s];t==r.index&&(void 0!==r.moduleStr&&(n=r.moduleStr,e=r.moduleStr.length),void 0!==r.fieldStr&&(o=r.fieldStr,i=r.fieldStr.length))}s.copyBuffer($(e)),s.copyBuffer(n),s.copyBuffer($(i)),s.copyBuffer(o);const r=s.readUint8();if(0==r)this._importFuncCount++,s.readVarUint32();else if(1==r){s.readUint8();const t=s.readUint8();s.readVarUint32(),t&&s.readVarUint32()}else if(2==r){const t=s.readUint8();s.readVarUint32(),t&&s.readVarUint32()}else{if(3!=r)throw"Invalid type kind: "+r;this._importGlobalCount++,s.readUint8(),s.readUint8()}if("function"==typeof this._globalImportCallback){const t={};t.module=n,t.field=o,t.kind=r,this._globalImportCallback(t)}s.commitBytes()}let c=n,u=0,l=0;for(let t=0;t<r.length;t++,c++){s.commitBytes();const e=r[t],n=Q(e.moduleStr),i=$(n.length),o=Q(e.fieldStr),a=$(o.length),c=[e.kind];let f;if(0==e.kind){if(e.type instanceof Z)f=e.type.value;else{if(e.type instanceof X)throw new Error("Untyped WailVariable in _addImportSection()");f=$(e.type)}e.variable instanceof X&&(e.variable.value=this._importFuncCount+u),u++}else 3==e.kind&&(f=[e.type,e.mutability],e.variable instanceof X&&(e.variable.value=this._importGlobalCount+l),l++);s.copyBuffer(i),s.copyBuffer(n),s.copyBuffer(a),s.copyBuffer(o),s.copyBuffer(c),s.copyBuffer(f)}const f=$(c),d=s.write(),h=$(f.length+d.length);this.copyBuffer(h),this.copyBuffer(f),this.copyBuffer(d),0==this._resolvedTables&&this._resolveTableIndices()}_addFunctionSection(){const t=new st,e=this._sectionOptions[3].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++){let i,o=e[n];if(o.type instanceof Z)i=o.type.value;else{if(o.type instanceof X)throw new Error("Untyped WailVariable in _parseFunctionSection()");i=$(o.type)}if(t.copyBuffer(i),o.variable instanceof X){const t=n+this._importFuncCount;o.variable.value=this._getAdjustedFunctionIndex(t)}}const i=t.write(),o=$(i.length);this.copyBuffer([3]),this.copyBuffer(o),this.copyBuffer(i)}_parseFunctionSection(){this.commitBytes();const t=this._sectionOptions[3].newEntries,e=this._sectionOptions[3].existingEntries,n=this.readVarUint32(),i=this.inPos,o=this.readVarUint32(),s=this.inPos-i,r=this.readBytes(n-s),a=new st(r);let c=!1;window.UnityWebModkit.Runtime&&window.UnityWebModkit.Runtime.internalWasmFunctions||(c=!0,window.UnityWebModkit.Runtime.internalWasmFunctions=[]);for(let t=0;t<o;t++){a.commitBytes();let n=a.readVarUint32();for(let i=0;i<e.length;i++){const o=e[i];t==o.index&&(n=o.type)}a.copyBuffer($(n)),c&&window.UnityWebModkit.Runtime.internalWasmFunctions.push({funcType:n})}let u=o;for(let e=0;e<t.length;e++,u++){let n,i=t[e];if(i.type instanceof Z)n=i.type.value;else{if(i.type instanceof X)throw new Error("Untyped WailVariable in _parseFunctionSection()");n=$(i.type)}if(a.copyBuffer(n),i.variable instanceof X){const t=u+this._importFuncCount;i.variable.value=this._getAdjustedFunctionIndex(t)}}const l=$(u),f=a.write(),d=$(l.length+f.length);this.copyBuffer(d),this.copyBuffer(l),this.copyBuffer(f)}_addGlobalSection(){const t=new st,e=this._sectionOptions[6].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++){const i=e[n];t.copyBuffer(j(i.globalType.contentType)),t.copyBuffer(j(i.globalType.mutability));const o=this._expandArrayVariables(i.initExpr);t.copyBuffer(o),i.variable instanceof X&&(i.variable.value=this._importGlobalCount+n)}const i=t.write(),o=$(i.length);this.copyBuffer([6]),this.copyBuffer(o),this.copyBuffer(i)}_parseGlobalSection(){this.commitBytes();const t=this.readVarUint32(),e=this.inPos,n=this.readVarUint32(),i=this.inPos-e,o=this.readBytes(t-i),s=new st(o),r=this._sectionOptions[6].newEntries,a=this._sectionOptions[6].existingEntries,c=n+r.length;s.copyBuffer($(c));for(let t=0;t<n;t++){let e,n,i;for(let i=0;i<a.length;i++){const o=a[i];let s=o.index;s instanceof X&&(s=s.value),t==s&&(e=o.globalType.contentType,n=o.globalType.mutability)}s.readUint8(),void 0!==e&&s.copyBuffer([e]),s.commitBytes(),s.readUint8(),void 0!==n&&s.copyBuffer([n]);do{i=this._readInstruction(s)}while(i[0]!=z);s.commitBytes()}for(let t=0;t<r.length;t++){const e=r[t];s.copyBuffer([e.globalType.contentType]),s.copyBuffer([e.globalType.mutability]),s.copyBuffer(this._expandArrayVariables(e.initExpr)),e.variable instanceof X&&(e.variable.value=this._importGlobalCount+n+t)}const u=s.write(),l=$(u.length);this.copyBuffer(l),this.copyBuffer(u)}_addExportSection(){const t=new st,e=this._sectionOptions[7].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++){const i=e[n],o=Q(i.fieldStr),s=$(o.length),r=j(i.kind);let a;if(i.index instanceof Z)a=i.index.value;else{if(i.index instanceof X)throw new Error("Untyped WailVariable in _parseExportSection()");a=$(i.index)}t.copyBuffer(s),t.copyBuffer(o),t.copyBuffer(r),t.copyBuffer(a)}const i=t.write(),o=$(i.length);this.copyBuffer([7]),this.copyBuffer(o),this.copyBuffer(i)}_parseExportSection(){this.commitBytes();const t=this.readVarUint32(),e=this.readBytes(t),n=new st(e),i=n.readVarUint32(),o=this._sectionOptions[7].newEntries,s=this._sectionOptions[7].existingEntries,r=i+o.length;n.copyBuffer($(r));for(let t=0;t<i;t++){n.commitBytes();let e=n.readVarUint32(),i=n.readBytes(e),o=n.readUint8(),r=n.readVarUint32();for(let n=0;n<s.length;n++){const a=s[n];t==a.index&&(void 0!==a.fieldStr&&(i=a.fieldStr,e=a.fieldStr.length),void 0!==a.kind&&(o=a.kind),void 0!==a.funcIndex&&(r=a.funcIndex))}let a=r;if(r instanceof X?a=r.value:0==o?a=this._getAdjustedFunctionIndex(r):3==o&&(a=this._getAdjustedGlobalIndex(r)),n.copyBuffer($(e)),n.copyBuffer(i),n.copyBuffer([o]),n.copyBuffer($(a)),"function"==typeof this._globalExportCallback){const t={};t.field=i,t.kind=o,this._globalExportCallback(t)}}for(let t=0;t<o.length;t++){const e=o[t],i=Q(e.fieldStr),s=$(i.length),r=j(e.kind);let a;if(e.index instanceof Z)a=e.index.value;else{if(e.index instanceof X)throw new Error("Untyped WailVariable in _parseExportSection()");a=$(e.index)}n.copyBuffer(s),n.copyBuffer(i),n.copyBuffer(r),n.copyBuffer(a)}const a=n.write(),c=$(a.length);this.copyBuffer(c),this.copyBuffer(a)}_parseStartSection(){this.commitBytes(),this.readVarUint32();const t=this.readVarUint32(),e=this._sectionOptions[8].existingEntries;let n;if(e.length>0)for(let t=0;t<e.length;t++){const i=e[t];if("number"==typeof i)n=i;else{if(!(i instanceof X))throw new Error("Invalid function index in _parseStartSection()");n=i.value}}else n=this._getAdjustedFunctionIndex(t);const i=$(n),o=$(i.length);this.copyBuffer(o),this.copyBuffer(i)}_addElementSection(){const t=new st,e=this._sectionOptions[9].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++,newCount++){const i=e[n],o=i.index;if(0!=o)throw new Error("Unsupported element index "+o);const s=i.offset,r=this._expandArrayVariables(i.elems),a=r.length;t.copyBuffer($(o)),t.copyBuffer(s),t.copyBuffer($(a)),t.copyBuffer(r)}const i=t.write(),o=$(i.length);this.copyBuffer([9]),this.copyBuffer(o),this.copyBuffer(i)}_parseElementSection(){this.commitBytes();const t=this.readVarUint32(),e=this.inPos,n=this.readVarUint32(),i=this.inPos-e,o=this.readBytes(t-i),s=new st(o),r=this._sectionOptions[9].newEntries,a=this._sectionOptions[9].existingEntries;let c=!1;window.UnityWebModkit.Runtime&&window.UnityWebModkit.Runtime.internalMappings||(c=!0,window.UnityWebModkit.Runtime.internalMappings=[]);for(let t=0;t<n;t++){let e,n=s.readVarUint32();do{e=this._readInstruction(s)}while(e[0]!=z);s.commitBytes();let i=s.readVarUint32(),o=[];for(let t=0;t<i;t++){const t=s.readVarUint32(),e=this._getAdjustedFunctionIndex(t);o.push(e)}for(let e=0;e<a.length;e++){const n=a[e];t==n.index&&void 0!==n.elems&&(o=n.elems,i=o.length)}s.copyBuffer($(i));for(let t=0;t<i;t++)s.copyBuffer($(o[t]));c&&window.UnityWebModkit.Runtime.internalMappings.push({index:n,elements:o})}let u=n;for(let t=0;t<r.length;t++,u++){const e=r[t],n=e.index;if(0!=n)throw new Error("Unsupported element index "+n);const i=e.offset,o=this._expandArrayVariables(e.elems),a=o.length;s.copyBuffer($(n)),s.copyBuffer(i),s.copyBuffer($(a)),s.copyBuffer(o)}const l=s.write(),f=$(u),d=$(f.length+l.length);this.copyBuffer(d),this.copyBuffer(f),this.copyBuffer(l)}_addCodeSection(){const t=new st,e=this._sectionOptions[10].newEntries,n=$(e.length);t.copyBuffer(n);const i=t.write(),o=$(i.length);this.copyBuffer([10]),this.copyBuffer(o),this.copyBuffer(i)}_parseCodeSection(){this.commitBytes();const t=this.readVarUint32(),e=this.readBytes(t),n=new st(e),i=n.readVarUint32(),o=this._sectionOptions[10].newEntries,s=i+o.length;n.copyBuffer($(s));let r=!1;window.UnityWebModkit.Runtime&&window.UnityWebModkit.Runtime.internalWasmCode||(r=!0,window.UnityWebModkit.Runtime.internalWasmCode=[]);for(let t=0;t<i;t++){const e=this._getAdjustedFunctionIndex(this._importFuncCount+t),i=this._readFunction(n,e);i.preservedIndex=t,r&&74===i.instructions.length&&window.UnityWebModkit.Runtime.internalWasmCode.push(i)}for(let t=i;t<s;t++){const e=this._funcSectionIndexToFuncTableIndex(t),i=new st;let s,r=!1;for(let t=0;t<o.length;t++){s=o[t];let n=s.index;if(n instanceof X&&(n=n.value),n==e){r=!0;break}}if(!r)throw new Error("No CODE entry found for index "+e);let a=s.locals,c=s.code;i.copyBuffer($(a.length));for(let t=0;t<a.length;t++){const e=a[t];i.copyBuffer($(1)),i.copyBuffer(j(e))}c=this._expandArrayVariables(c),i.copyBuffer(c);const u=i.write(),l=$(u.length);n.copyBuffer(l),n.copyBuffer(u)}const a=n.write(),c=$(a.length);this.copyBuffer(c),this.copyBuffer(a)}_addDataSection(){const t=new st,e=this._sectionOptions[11].newEntries,n=$(e.length);t.copyBuffer(n);for(let n=0;n<e.length;n++){const i=e[n];let o;o=void 0!==i.index?$(i.index):$(0);const s=i.offset;s[s.length-1]!=z&&s.push(z);const r=i.data,a=$(r.length);t.copyBuffer(o),t.copyBuffer(s),t.copyBuffer(a),t.copyBuffer(r)}const i=t.write(),o=$(i.length);this.copyBuffer([11]),this.copyBuffer(o),this.copyBuffer(i)}_parseDataSection(){this.commitBytes();const t=this.readVarUint32(),e=this.inPos,n=this.readVarUint32(),i=this.inPos-e,o=this.readBytes(t-i),s=new st(o),r=this._sectionOptions[11].newEntries,a=this._sectionOptions[11].existingEntries,c=n+r.length;s.copyBuffer($(c));for(let t=0;t<n;t++){let e;do{e=this._readInstruction(s)}while(e[0]!==z);s.commitBytes();let n=s.readVarUint32(),i=s.readBytes(n);for(let e=0;e<a.length;e++){const o=a[e];t==o.index&&void 0!==o.data&&(i=o.data,n=i.length)}s.copyBuffer($(n)),s.copyBuffer(i)}for(let t=0;t<r.length;t++){const e=r[t];let n;n=void 0!==e.index?$(e.index):$(0);const i=e.offset;i[i.length-1]!=z&&i.push(z);const o=e.data,a=$(o.length);s.copyBuffer(n),s.copyBuffer(i),s.copyBuffer(a),s.copyBuffer(o)}const u=s.write(),l=$(u.length);this.copyBuffer(l),this.copyBuffer(u)}_readFunction(t,e){const n=this._sectionOptions[10].existingEntries,i=t.readVarUint32(),o=t.readBytes(i),s=new st(o),r=s.readVarUint32(),a=[],c=[];for(let t=0;t<r;t++)a.push(...Array(s.readVarUint32()).fill(N[s.readUint8()]));s.commitBytes();const u=new st(o.subarray(s.inPos));for(;u.inPos<u.inBuffer.length;){const t=this._readInstruction(u);1===a.length&&"i32"===a[0]&&c.push(t),u.commitBytes()}let l=s.write(),f=u.write();if("function"==typeof this._globalFunctionCallback){const t={};t.bytes=u.write(),t.index=e;const n=this._globalFunctionCallback(t);!1!==n&&(f=n)}else for(let t=0;t<this._functionCallbacks.length;t++){const n=this._functionCallbacks[t];let i=n.index;if(i instanceof X&&(i=i.value),i===e){const t={};t.bytes=u.write(),t.index=e;const i=n.callback(t);!1!==i&&(f=i)}}for(let t=0;t<n.length;t++){const i=n[t];let o=i.index;if(o instanceof X&&(o=o.value),e==o){const t=new st,e=new st,n=i.locals;t.copyBuffer($(n.length));for(let e=0;e<n.length;e++){const i=n[e];t.copyBuffer($(1)),t.copyBuffer(j(i))}const o=this._expandArrayVariables(i.code);e.copyBuffer(o),l=t.write(),f=e.write()}}let d=$(l.length+f.length);return t.copyBuffer(d),t.copyBuffer(l),t.copyBuffer(f),{locals:a,instructions:c}}_readInstruction(t){t.commitBytes(),t.setAnchor();const e=t.readUint8();let n,i,o;switch(e){case 0:case 1:case 5:case z:case 15:case 26:case 27:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 124:case 125:case 126:case 127:case 128:case 129:case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 174:case 175:case 176:case 177:case 178:case 179:case 180:case 181:case 182:case 183:case 184:case 185:case 186:case 187:case 188:case 189:case 190:case 191:break;case 2:case 3:case 4:case 63:case 64:t.readUint8();break;case 12:case 13:case 32:case 33:case 34:case 65:case 66:t.readVarUint32();break;case 35:case 36:t.commitBytes(),n=t.readVarUint32(),i=this._getAdjustedGlobalIndex(n),t.copyBuffer($(i));break;case 67:t.readBytes(4);break;case 68:t.readBytes(8);break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:t.readVarUint32(),t.readVarUint32();break;case 14:const s=t.readVarUint32();for(let e=0;e<s;e++)t.readVarUint32();t.readVarUint32();break;case 16:t.commitBytes(),n=t.readVarUint32(),i=this._getAdjustedFunctionIndex(n),t.copyBuffer($(i));break;case 17:t.readVarUint32(),t.readUint8();break;case 192:case 193:case 194:case 195:case 196:break;case 252:switch(o=t.readUint8(),o){case 8:case 12:t.readVarUint32(),t.readUint8();break;case 9:case 13:t.readVarUint32();break;case 10:case 14:t.readUint8(),t.readUint8();break;case 11:t.readUint8();break;default:throw new Error("Unknown argument '"+o+"' for OP_BULK_MEMORY")}break;case 253:switch(o=t.readUint8(),o){case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 96:case 97:case 99:case 100:case 101:case 102:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 118:case 119:case 120:case 121:case 123:case 128:case 129:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:case 144:case 145:case 146:case 147:case 149:case 150:case 151:case 152:case 153:case 155:case 160:case 161:case 163:case 164:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 174:case 177:case 181:case 182:case 183:case 184:case 185:case 186:case 192:case 193:case 196:case 199:case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 209:case 213:case 103:case 104:case 105:case 106:case 116:case 117:case 122:case 148:case 224:case 225:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 239:case 240:case 241:case 242:case 243:case 244:case 245:case 246:case 247:case 248:case 249:case 250:case 251:case 156:case 157:case 158:case 159:case 188:case 189:case 190:case 191:case 220:case 221:case 222:case 223:case 130:case 83:case 214:case 215:case 216:case 217:case 218:case 219:case 195:case 254:case 255:case 252:case 253:case 94:case 95:case 98:case 124:case 125:case 126:case 127:break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 92:case 93:t.readVarUint32(),t.readVarUint32();break;case 13:case 12:t.readUint128();break;case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:t.readUint8();break;case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:t.readVarUint32(),t.readVarUint32(),t.readUint8();break;default:throw new Error("Unknown argument '"+o+"' for OP_SIMD")}break;case 254:if(o=t.readUint8(),o>78||o>2&&o<16)throw new Error("Unknown argument '"+o+"' for OP_ATOMIC. Probably parsing incorrectly");t.readVarUint32(),t.readVarUint32();break;default:throw new Error("Unknown opcode '"+e+"'. Probably parsing incorrectly")}if(t.commitBytes(),void 0!==this._instructionCallbacks[e]){const n=t.readFromAnchor(),i=this._instructionCallbacks[e](n);t.writeAtAnchor(i)}else if("function"==typeof this._globalInstructionCallback){const n=t.readFromAnchor(),i=this._globalInstructionCallback[e](n);t.writeAtAnchor(i)}return t.readFromAnchor()}_funcSectionIndexToFuncTableIndex(t){return t+this._importFuncCount+this._importFuncNewCount}_getAdjustedFunctionIndex(t){return t>=this._importFuncCount?t+this._importFuncNewCount:t}_getAdjustedGlobalIndex(t){return t>=this._importGlobalCount?t+this._importGlobalNewCount:t}}var at,ct=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((i=i.apply(t,e||[])).next())}))};class ut{constructor(t,e,n){this._referencedAssemblies=[],this._hooks=[],this.name=t,this.version=e,this.logger=new i(t),this._runtime=n}get hooks(){return this._hooks}get referencedAssemblies(){return this._referencedAssemblies}hookPrefix(t,e){this._hooks.push({typeName:t.typeName,methodName:t.methodName,params:t.params,returnType:t.returnType,applied:!1,kind:0,callback:e})}hookPostfix(t,e){this._hooks.push({typeName:t.typeName,methodName:t.methodName,params:t.params,returnType:t.returnType,applied:!1,kind:1,callback:e})}referenceAssemblies(t){this._referencedAssemblies=t}call(t,e,n){const i=window.game||game,o=this._runtime.tableName||this._runtime.resolveTableName(i.instance.Module.asm);if("string"==typeof e){const s=this._runtime.getTableIndex(t,e);if(-1===s)throw new Error("Failed to invoke function! Could not find table index for "+t+"$$"+e);const r=i.instance.Module.asm[o].get(s)(...n);return new lt(r)}if("object"==typeof e||void 0===e){const[n,s]=t.replace("::","$$").split("$$"),r=this._runtime.getTableIndex(n,s);if(-1===r)throw new Error("Failed to invoke function! Could not find table index for "+n+"$$"+s);e||(e=[]);const a=i.instance.Module.asm[o].get(r)(...e);return new lt(a)}}createMstr(t){return this._runtime.createMstr(t)}malloc(t){return new lt(this._runtime.malloc(t))}free(t){this._runtime.free(t)}}class lt{constructor(t){this._result=t}set(t){this._result=t}val(){return this._result}mstr(){return lt.readUtf16Char(this._result+12)}getClassName(){const t=window.game||game,e=new DataView(t.instance.Module.HEAPU8.slice(this._result,this._result+4).buffer).getUint32(0,!0);let n=new DataView(t.instance.Module.HEAPU8.slice(e+8,e+12).buffer).getUint32(0,!0);return new J(t.instance.Module.HEAPU8.slice(n,n+128).buffer).readNullTerminatedUTF8String()}readField(t,e){const n=window.game||game,i=this._result+t;let o=n.instance.Module.HEAPU8.slice(i,i+16);const s=new J(o.buffer);switch(e){case"i32":return new lt(s.readInt32());case"f32":return new lt(s.readFloat());case"u8":return new lt(s.readUint8());case"u32":return new lt(s.readUint32())}}writeField(t,e,n){const i=window.game||game,o=new U(new ArrayBuffer("f32"===e||"i32"===e||"u32"===e?4:8));switch(e){case"i32":o.writeInt32(n);break;case"u32":o.writeUint32(n);break;case"f32":o.writeFloat(n)}S(i.instance.Module.HEAPU8,o.finalize(),this._result+t)}static readUtf16Char(t){const e=window.game||game;let n=new Uint16Array(e.instance.Module.HEAPU8.buffer),i=t/2,o=[],s=n[i];for(;0!==s;)o.push(s),i++,s=n[i];return new TextDecoder("utf-16le").decode(new Uint16Array(o))}}!function(t){t[t.None=0]="None",t[t.Backspace=8]="Backspace",t[t.Tab=9]="Tab",t[t.Clear=12]="Clear",t[t.Return=13]="Return",t[t.Pause=19]="Pause",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.Exclaim=33]="Exclaim",t[t.DoubleQuote=34]="DoubleQuote",t[t.Hash=35]="Hash",t[t.Dollar=36]="Dollar",t[t.Ampersand=38]="Ampersand",t[t.Quote=39]="Quote",t[t.LeftParen=40]="LeftParen",t[t.RightParen=41]="RightParen",t[t.Asterisk=42]="Asterisk",t[t.Plus=43]="Plus",t[t.Comma=44]="Comma",t[t.Minus=45]="Minus",t[t.Period=46]="Period",t[t.Slash=47]="Slash",t[t.Alpha0=48]="Alpha0",t[t.Alpha1=49]="Alpha1",t[t.Alpha2=50]="Alpha2",t[t.Alpha3=51]="Alpha3",t[t.Alpha4=52]="Alpha4",t[t.Alpha5=53]="Alpha5",t[t.Alpha6=54]="Alpha6",t[t.Alpha7=55]="Alpha7",t[t.Alpha8=56]="Alpha8",t[t.Alpha9=57]="Alpha9",t[t.Colon=58]="Colon",t[t.Semicolon=59]="Semicolon",t[t.Less=60]="Less",t[t.Equals=61]="Equals",t[t.Greater=62]="Greater",t[t.Question=63]="Question",t[t.At=64]="At",t[t.LeftBracket=91]="LeftBracket",t[t.Backslash=92]="Backslash",t[t.RightBracket=93]="RightBracket",t[t.Caret=94]="Caret",t[t.Underscore=95]="Underscore",t[t.BackQuote=96]="BackQuote",t[t.A=97]="A",t[t.B=98]="B",t[t.C=99]="C",t[t.D=100]="D",t[t.E=101]="E",t[t.F=102]="F",t[t.G=103]="G",t[t.H=104]="H",t[t.I=105]="I",t[t.J=106]="J",t[t.K=107]="K",t[t.L=108]="L",t[t.M=109]="M",t[t.N=110]="N",t[t.O=111]="O",t[t.P=112]="P",t[t.Q=113]="Q",t[t.R=114]="R",t[t.S=115]="S",t[t.T=116]="T",t[t.U=117]="U",t[t.V=118]="V",t[t.W=119]="W",t[t.X=120]="X",t[t.Y=121]="Y",t[t.Z=122]="Z",t[t.Delete=127]="Delete",t[t.Keypad0=256]="Keypad0",t[t.Keypad1=257]="Keypad1",t[t.Keypad2=258]="Keypad2",t[t.Keypad3=259]="Keypad3",t[t.Keypad4=260]="Keypad4",t[t.Keypad5=261]="Keypad5",t[t.Keypad6=262]="Keypad6",t[t.Keypad7=263]="Keypad7",t[t.Keypad8=264]="Keypad8",t[t.Keypad9=265]="Keypad9",t[t.KeypadPeriod=266]="KeypadPeriod",t[t.KeypadDivide=267]="KeypadDivide",t[t.KeypadMultiply=268]="KeypadMultiply",t[t.KeypadMinus=269]="KeypadMinus",t[t.KeypadPlus=270]="KeypadPlus",t[t.KeypadEnter=271]="KeypadEnter",t[t.KeypadEquals=272]="KeypadEquals",t[t.UpArrow=273]="UpArrow",t[t.DownArrow=274]="DownArrow",t[t.RightArrow=275]="RightArrow",t[t.LeftArrow=276]="LeftArrow",t[t.Insert=277]="Insert",t[t.Home=278]="Home",t[t.End=279]="End",t[t.PageUp=280]="PageUp",t[t.PageDown=281]="PageDown",t[t.F1=282]="F1",t[t.F2=283]="F2",t[t.F3=284]="F3",t[t.F4=285]="F4",t[t.F5=286]="F5",t[t.F6=287]="F6",t[t.F7=288]="F7",t[t.F8=289]="F8",t[t.F9=290]="F9",t[t.F10=291]="F10",t[t.F11=292]="F11",t[t.F12=293]="F12",t[t.F13=294]="F13",t[t.F14=295]="F14",t[t.F15=296]="F15",t[t.Numlock=300]="Numlock",t[t.CapsLock=301]="CapsLock",t[t.ScrollLock=302]="ScrollLock",t[t.RightShift=303]="RightShift",t[t.LeftShift=304]="LeftShift",t[t.RightControl=305]="RightControl",t[t.LeftControl=306]="LeftControl",t[t.RightAlt=307]="RightAlt",t[t.LeftAlt=308]="LeftAlt",t[t.RightApple=309]="RightApple",t[t.RightCommand=309]="RightCommand",t[t.LeftApple=310]="LeftApple",t[t.LeftCommand=310]="LeftCommand",t[t.LeftWindows=311]="LeftWindows",t[t.RightWindows=312]="RightWindows",t[t.AltGr=313]="AltGr",t[t.Help=315]="Help",t[t.Print=316]="Print",t[t.SysReq=317]="SysReq",t[t.Break=318]="Break",t[t.Menu=319]="Menu",t[t.Mouse0=323]="Mouse0",t[t.Mouse1=324]="Mouse1",t[t.Mouse2=325]="Mouse2",t[t.Mouse3=326]="Mouse3",t[t.Mouse4=327]="Mouse4",t[t.Mouse5=328]="Mouse5",t[t.Mouse6=329]="Mouse6",t[t.JoystickButton0=330]="JoystickButton0",t[t.JoystickButton1=331]="JoystickButton1",t[t.JoystickButton2=332]="JoystickButton2",t[t.JoystickButton3=333]="JoystickButton3",t[t.JoystickButton4=334]="JoystickButton4",t[t.JoystickButton5=335]="JoystickButton5",t[t.JoystickButton6=336]="JoystickButton6",t[t.JoystickButton7=337]="JoystickButton7",t[t.JoystickButton8=338]="JoystickButton8",t[t.JoystickButton9=339]="JoystickButton9",t[t.JoystickButton10=340]="JoystickButton10",t[t.JoystickButton11=341]="JoystickButton11",t[t.JoystickButton12=342]="JoystickButton12",t[t.JoystickButton13=343]="JoystickButton13",t[t.JoystickButton14=344]="JoystickButton14",t[t.JoystickButton15=345]="JoystickButton15",t[t.JoystickButton16=346]="JoystickButton16",t[t.JoystickButton17=347]="JoystickButton17",t[t.JoystickButton18=348]="JoystickButton18",t[t.JoystickButton19=349]="JoystickButton19",t[t.Joystick1Button0=350]="Joystick1Button0",t[t.Joystick1Button1=351]="Joystick1Button1",t[t.Joystick1Button2=352]="Joystick1Button2",t[t.Joystick1Button3=353]="Joystick1Button3",t[t.Joystick1Button4=354]="Joystick1Button4",t[t.Joystick1Button5=355]="Joystick1Button5",t[t.Joystick1Button6=356]="Joystick1Button6",t[t.Joystick1Button7=357]="Joystick1Button7",t[t.Joystick1Button8=358]="Joystick1Button8",t[t.Joystick1Button9=359]="Joystick1Button9",t[t.Joystick1Button10=360]="Joystick1Button10",t[t.Joystick1Button11=361]="Joystick1Button11",t[t.Joystick1Button12=362]="Joystick1Button12",t[t.Joystick1Button13=363]="Joystick1Button13",t[t.Joystick1Button14=364]="Joystick1Button14",t[t.Joystick1Button15=365]="Joystick1Button15",t[t.Joystick1Button16=366]="Joystick1Button16",t[t.Joystick1Button17=367]="Joystick1Button17",t[t.Joystick1Button18=368]="Joystick1Button18",t[t.Joystick1Button19=369]="Joystick1Button19",t[t.Joystick2Button0=370]="Joystick2Button0",t[t.Joystick2Button1=371]="Joystick2Button1",t[t.Joystick2Button2=372]="Joystick2Button2",t[t.Joystick2Button3=373]="Joystick2Button3",t[t.Joystick2Button4=374]="Joystick2Button4",t[t.Joystick2Button5=375]="Joystick2Button5",t[t.Joystick2Button6=376]="Joystick2Button6",t[t.Joystick2Button7=377]="Joystick2Button7",t[t.Joystick2Button8=378]="Joystick2Button8",t[t.Joystick2Button9=379]="Joystick2Button9",t[t.Joystick2Button10=380]="Joystick2Button10",t[t.Joystick2Button11=381]="Joystick2Button11",t[t.Joystick2Button12=382]="Joystick2Button12",t[t.Joystick2Button13=383]="Joystick2Button13",t[t.Joystick2Button14=384]="Joystick2Button14",t[t.Joystick2Button15=385]="Joystick2Button15",t[t.Joystick2Button16=386]="Joystick2Button16",t[t.Joystick2Button17=387]="Joystick2Button17",t[t.Joystick2Button18=388]="Joystick2Button18",t[t.Joystick2Button19=389]="Joystick2Button19",t[t.Joystick3Button0=390]="Joystick3Button0",t[t.Joystick3Button1=391]="Joystick3Button1",t[t.Joystick3Button2=392]="Joystick3Button2",t[t.Joystick3Button3=393]="Joystick3Button3",t[t.Joystick3Button4=394]="Joystick3Button4",t[t.Joystick3Button5=395]="Joystick3Button5",t[t.Joystick3Button6=396]="Joystick3Button6",t[t.Joystick3Button7=397]="Joystick3Button7",t[t.Joystick3Button8=398]="Joystick3Button8",t[t.Joystick3Button9=399]="Joystick3Button9",t[t.Joystick3Button10=400]="Joystick3Button10",t[t.Joystick3Button11=401]="Joystick3Button11",t[t.Joystick3Button12=402]="Joystick3Button12",t[t.Joystick3Button13=403]="Joystick3Button13",t[t.Joystick3Button14=404]="Joystick3Button14",t[t.Joystick3Button15=405]="Joystick3Button15",t[t.Joystick3Button16=406]="Joystick3Button16",t[t.Joystick3Button17=407]="Joystick3Button17",t[t.Joystick3Button18=408]="Joystick3Button18",t[t.Joystick3Button19=409]="Joystick3Button19",t[t.Joystick4Button0=410]="Joystick4Button0",t[t.Joystick4Button1=411]="Joystick4Button1",t[t.Joystick4Button2=412]="Joystick4Button2",t[t.Joystick4Button3=413]="Joystick4Button3",t[t.Joystick4Button4=414]="Joystick4Button4",t[t.Joystick4Button5=415]="Joystick4Button5",t[t.Joystick4Button6=416]="Joystick4Button6",t[t.Joystick4Button7=417]="Joystick4Button7",t[t.Joystick4Button8=418]="Joystick4Button8",t[t.Joystick4Button9=419]="Joystick4Button9",t[t.Joystick4Button10=420]="Joystick4Button10",t[t.Joystick4Button11=421]="Joystick4Button11",t[t.Joystick4Button12=422]="Joystick4Button12",t[t.Joystick4Button13=423]="Joystick4Button13",t[t.Joystick4Button14=424]="Joystick4Button14",t[t.Joystick4Button15=425]="Joystick4Button15",t[t.Joystick4Button16=426]="Joystick4Button16",t[t.Joystick4Button17=427]="Joystick4Button17",t[t.Joystick4Button18=428]="Joystick4Button18",t[t.Joystick4Button19=429]="Joystick4Button19",t[t.Joystick5Button0=430]="Joystick5Button0",t[t.Joystick5Button1=431]="Joystick5Button1",t[t.Joystick5Button2=432]="Joystick5Button2",t[t.Joystick5Button3=433]="Joystick5Button3",t[t.Joystick5Button4=434]="Joystick5Button4",t[t.Joystick5Button5=435]="Joystick5Button5",t[t.Joystick5Button6=436]="Joystick5Button6",t[t.Joystick5Button7=437]="Joystick5Button7",t[t.Joystick5Button8=438]="Joystick5Button8",t[t.Joystick5Button9=439]="Joystick5Button9",t[t.Joystick5Button10=440]="Joystick5Button10",t[t.Joystick5Button11=441]="Joystick5Button11",t[t.Joystick5Button12=442]="Joystick5Button12",t[t.Joystick5Button13=443]="Joystick5Button13",t[t.Joystick5Button14=444]="Joystick5Button14",t[t.Joystick5Button15=445]="Joystick5Button15",t[t.Joystick5Button16=446]="Joystick5Button16",t[t.Joystick5Button17=447]="Joystick5Button17",t[t.Joystick5Button18=448]="Joystick5Button18",t[t.Joystick5Button19=449]="Joystick5Button19",t[t.Joystick6Button0=450]="Joystick6Button0",t[t.Joystick6Button1=451]="Joystick6Button1",t[t.Joystick6Button2=452]="Joystick6Button2",t[t.Joystick6Button3=453]="Joystick6Button3",t[t.Joystick6Button4=454]="Joystick6Button4",t[t.Joystick6Button5=455]="Joystick6Button5",t[t.Joystick6Button6=456]="Joystick6Button6",t[t.Joystick6Button7=457]="Joystick6Button7",t[t.Joystick6Button8=458]="Joystick6Button8",t[t.Joystick6Button9=459]="Joystick6Button9",t[t.Joystick6Button10=460]="Joystick6Button10",t[t.Joystick6Button11=461]="Joystick6Button11",t[t.Joystick6Button12=462]="Joystick6Button12",t[t.Joystick6Button13=463]="Joystick6Button13",t[t.Joystick6Button14=464]="Joystick6Button14",t[t.Joystick6Button15=465]="Joystick6Button15",t[t.Joystick6Button16=466]="Joystick6Button16",t[t.Joystick6Button17=467]="Joystick6Button17",t[t.Joystick6Button18=468]="Joystick6Button18",t[t.Joystick6Button19=469]="Joystick6Button19",t[t.Joystick7Button0=470]="Joystick7Button0",t[t.Joystick7Button1=471]="Joystick7Button1",t[t.Joystick7Button2=472]="Joystick7Button2",t[t.Joystick7Button3=473]="Joystick7Button3",t[t.Joystick7Button4=474]="Joystick7Button4",t[t.Joystick7Button5=475]="Joystick7Button5",t[t.Joystick7Button6=476]="Joystick7Button6",t[t.Joystick7Button7=477]="Joystick7Button7",t[t.Joystick7Button8=478]="Joystick7Button8",t[t.Joystick7Button9=479]="Joystick7Button9",t[t.Joystick7Button10=480]="Joystick7Button10",t[t.Joystick7Button11=481]="Joystick7Button11",t[t.Joystick7Button12=482]="Joystick7Button12",t[t.Joystick7Button13=483]="Joystick7Button13",t[t.Joystick7Button14=484]="Joystick7Button14",t[t.Joystick7Button15=485]="Joystick7Button15",t[t.Joystick7Button16=486]="Joystick7Button16",t[t.Joystick7Button17=487]="Joystick7Button17",t[t.Joystick7Button18=488]="Joystick7Button18",t[t.Joystick7Button19=489]="Joystick7Button19",t[t.Joystick8Button0=490]="Joystick8Button0",t[t.Joystick8Button1=491]="Joystick8Button1",t[t.Joystick8Button2=492]="Joystick8Button2",t[t.Joystick8Button3=493]="Joystick8Button3",t[t.Joystick8Button4=494]="Joystick8Button4",t[t.Joystick8Button5=495]="Joystick8Button5",t[t.Joystick8Button6=496]="Joystick8Button6",t[t.Joystick8Button7=497]="Joystick8Button7",t[t.Joystick8Button8=498]="Joystick8Button8",t[t.Joystick8Button9=499]="Joystick8Button9",t[t.Joystick8Button10=500]="Joystick8Button10",t[t.Joystick8Button11=501]="Joystick8Button11",t[t.Joystick8Button12=502]="Joystick8Button12",t[t.Joystick8Button13=503]="Joystick8Button13",t[t.Joystick8Button14=504]="Joystick8Button14",t[t.Joystick8Button15=505]="Joystick8Button15",t[t.Joystick8Button16=506]="Joystick8Button16",t[t.Joystick8Button17=507]="Joystick8Button17",t[t.Joystick8Button18=508]="Joystick8Button18",t[t.Joystick8Button19=509]="Joystick8Button19"}(at||(at={}));const ft=new class{constructor(){this.plugins=[],this.startedInitializing=!1,this.allReferencedAssemblies=[],this.resolvedIl2CppFunctions={},this.logger=new i("UnityWebModkit")}createPlugin(t,e="1.0.0"){this.startedInitializing||this.initialize();const n=new ut(t,e,this);return this.plugins.push(n),n}initialize(){return ct(this,void 0,void 0,(function*(){if("undefined"==typeof window)return void console.log("[37m[UnityWebModkit][0m [33m[WARN][0m Not running in a browser environment! Nothing will be executed.");this.startedInitializing=!0,this.hookWasmInstantiate();const t=yield(M.info("UnityWebModkit v%s - %s",dt,window.location.hostname),M.info("Build hash: %s",e.h()),function(){return M.debug("Trying to load Unity web data from indexedDB cache"),new Promise((t=>{indexedDB.databases().then((e=>O(this,void 0,void 0,(function*(){-1!=e.findIndex((t=>"UnityCache"===t.name))?window.indexedDB.open("UnityCache",3).onsuccess=e=>{const n=e.target.result,i=n.transaction(["RequestStore"],"readonly").objectStore("RequestStore").getAll();i.onsuccess=e=>O(this,void 0,void 0,(function*(){const n=e.target.result;0!==n.length?t(R(n[0].response.parsedBody.buffer)):t(yield V())})),i.onerror=()=>O(this,void 0,void 0,(function*(){n.close(),t(yield V())}))}:t(yield V())}))))}))}());this.logger.debug("Parsed web data into %d node(s)",t.nodes.length),t.unityVersion?this.logger.info("Running under Unity %s",t.unityVersion):this.logger.warn("Unable to determine Unity version from web data!"),this.loadGlobalMetadata(t)}))}loadGlobalMetadata(t){const e=t.getNode("Il2CppData/Metadata/global-metadata.dat");if(!e||!e.data)return void this.logger.error(new s("Unable to find global-metadata.dat! The game may be encrypted, corrupt or unsupported.").print());this.allReferencedAssemblies=this.plugins.flatMap((t=>t.referencedAssemblies));const n=function(t,e){const n=new J(t);if(4205910959!==n.readUint32())return b(new r("Metadata file supplied is not a valid metadata file."));const i=n.readUint32();if(i<0||i>1e3)return b(new r("Metadata file supplied is not a valid metadata file."));if(29!==i)return b(new r(`Metadata file supplied is not a supported version [${i}].`));n.seek(0);const o=function(t){return{sanity:t.readUint32(),version:t.readInt32(),stringLiteralOffset:t.readUint32(),stringLiteralSize:t.readInt32(),stringLiteralDataOffset:t.readUint32(),stringLiteralDataSize:t.readInt32(),stringOffset:t.readUint32(),stringSize:t.readInt32(),eventsOffset:t.readUint32(),eventsSize:t.readInt32(),propertiesOffset:t.readUint32(),propertiesSize:t.readInt32(),methodsOffset:t.readUint32(),methodsSize:t.readInt32(),parameterDefaultValuesOffset:t.readUint32(),parameterDefaultValuesSize:t.readInt32(),fieldDefaultValuesOffset:t.readUint32(),fieldDefaultValuesSize:t.readInt32(),fieldAndParameterDefaultValueDataOffset:t.readUint32(),fieldAndParameterDefaultValueDataSize:t.readInt32(),fieldMarshaledSizesOffset:t.readInt32(),fieldMarshaledSizesSize:t.readInt32(),parametersOffset:t.readUint32(),parametersSize:t.readInt32(),fieldsOffset:t.readUint32(),fieldsSize:t.readInt32(),genericParametersOffset:t.readUint32(),genericParametersSize:t.readInt32(),genericParameterConstraintsOffset:t.readUint32(),genericParameterConstraintsSize:t.readInt32(),genericContainersOffset:t.readUint32(),genericContainersSize:t.readInt32(),nestedTypesOffset:t.readUint32(),nestedTypesSize:t.readInt32(),interfacesOffset:t.readUint32(),interfacesSize:t.readInt32(),vtableMethodsOffset:t.readUint32(),vtableMethodsSize:t.readInt32(),interfaceOffsetsOffset:t.readInt32(),interfaceOffsetsSize:t.readInt32(),typeDefinitionsOffset:t.readUint32(),typeDefinitionsSize:t.readInt32(),imagesOffset:t.readUint32(),imagesSize:t.readInt32(),assembliesOffset:t.readUint32(),assembliesSize:t.readInt32(),fieldRefsOffset:t.readUint32(),fieldRefsSize:t.readInt32(),referencedAssembliesOffset:t.readInt32(),referencedAssembliesSize:t.readInt32(),attributeDataOffset:t.readUint32(),attributeDataSize:t.readInt32(),attributeDataRangeOffset:t.readUint32(),attributeDataRangeSize:t.readInt32(),unresolvedVirtualCallParameterTypesOffset:t.readInt32(),unresolvedVirtualCallParameterTypesSize:t.readInt32(),unresolvedVirtualCallParameterRangesOffset:t.readInt32(),unresolvedVirtualCallParameterRangesSize:t.readInt32(),windowsRuntimeTypeNamesOffset:t.readInt32(),windowsRuntimeTypeNamesSize:t.readInt32(),windowsRuntimeStringsOffset:t.readInt32(),windowsRuntimeStringsSize:t.readInt32(),exportedTypeDefinitionsOffset:t.readInt32(),exportedTypeDefinitionsSize:t.readInt32()}}(n),s=function(t,e,n){t.seek(e);const i=[],o=e+n;for(;t.offset<o;)i.push({nameIndex:t.readUint32(),assemblyIndex:t.readInt32(),typeStart:t.readInt32(),typeCount:t.readUint32(),exportedTypeStart:t.readInt32(),exportedTypeCount:t.readUint32(),entryPointIndex:t.readInt32(),token:t.readUint32(),customAttributeStart:t.readInt32(),customAttributeCount:t.readUint32()});return i}(n,o.imagesOffset,o.imagesSize),a=[];for(var c=0,u=s.length;c<u;){const t=s[c],i=x(n,o.stringOffset,t.nameIndex);(null==e?void 0:e.includes(i))&&a.push(t),c++}let l=function(t,e,n,i){t.seek(e);const o=[],s=e+n;let r=0;for(;t.offset<s;){const n={typeIndex:r,nameIndex:t.readUint32(),namespaceIndex:t.readUint32(),byvalTypeIndex:t.readInt32(),declaringTypeIndex:t.readInt32(),parentIndex:t.readInt32(),elementTypeIndex:t.readInt32(),genericContainerIndex:t.readInt32(),flags:t.readUint32(),fieldStart:t.readInt32(),methodStart:t.readInt32(),eventStart:t.readInt32(),propertyStart:t.readInt32(),nestedTypesStart:t.readInt32(),interfacesStart:t.readInt32(),vtableStart:t.readInt32(),interfaceOffsetsStart:t.readInt32(),method_count:t.readUint16(),property_count:t.readUint16(),field_count:t.readUint16(),event_count:t.readUint16(),nested_type_count:t.readUint16(),vtable_count:t.readUint16(),interfaces_count:t.readUint16(),interface_offsets_count:t.readUint16(),bitfield:t.readUint32(),token:t.readUint32()};r++,C(i,e,t.offset-1)&&o.push(n)}return o}(n,o.typeDefinitionsOffset,o.typeDefinitionsSize,a);const f=function(t,e,n){t.seek(e);const i=[],o=e+n;let s=0;for(;t.offset<o;)i.push({methodIndex:s,nameIndex:t.readUint32(),declaringType:t.readInt32(),returnType:t.readInt32(),parameterStart:t.readInt32(),genericContainerIndex:t.readInt32(),token:t.readUint32(),flags:t.readUint16(),iflags:t.readUint16(),slot:t.readUint16(),parameterCount:t.readUint16()}),s++;return i}(n,o.methodsOffset,o.methodsSize),d=[];for(c=0,u=f.length;c<u;){const t=f[c];-1!==l.findIndex((e=>e.typeIndex===t.declaringType))&&d.push(t),c++}return w({buffer:t,header:o,imageDefs:a,typeDefs:l,methodDefs:f,originalImageDefCount:s.length,originalMethodDefCount:f.length,version:i})}(e.data,this.allReferencedAssemblies);n.isErr()?this.logger.error(n.error.print()):this.globalMetadata=n.value}hookWasmInstantiate(){this.instantiateStreaming=WebAssembly.instantiateStreaming,WebAssembly.instantiateStreaming=this.onWebAssemblyInstantiateStreaming.bind(this)}onWebAssemblyInstantiateStreaming(t,e){var n;return ct(this,void 0,void 0,(function*(){var i;if(yield(i=()=>this.globalMetadata,new Promise((t=>{const e=()=>{i()?t():setTimeout(e,400)};e()}))),0===(null===(n=this.globalMetadata)||void 0===n?void 0:n.imageDefs.length))return this.instantiateStreaming(t,e);let o;if(t instanceof Promise)o=yield t.then((t=>t.arrayBuffer()));else{if(!(t instanceof Response))return this.logger.error("TypeError: Got an unexpected object type as the first argument to WebAssembly.instantiateStreaming"),Promise.reject();o=yield t.arrayBuffer()}return this.handleBuffer(o,e)}))}handleBuffer(t,e){return new Promise(((n,i)=>{if(e||(e={}),this.searchWasmBinary(t),!this.il2CppContext)return void i();const o=new Uint8Array(t),s=new rt(o);s._optionalSectionFlags|=1024,s._optionalSectionFlags|=512,s._optionalSectionFlags|=2,s.parse(),this.resolveIl2CppFunctions(e);const r=new rt(o);this.exportIl2CppFunctions(r),this.logger.message("Chainloader initialized"),this.logger.info("%d plugin(s) to load",this.plugins.length);const a=[],c=[];for(var u=0,l=this.plugins.length;u<l;){const t=this.plugins[u];this.logger.info("Loading [%s %s]",t.name,t.version);for(var f=0,d=t.hooks.length;f<d;){const n=t.hooks[f];n.tableIndex=this.getTableIndex(n.typeName,n.methodName),n.index=this.getInternalIndex(n.tableIndex);const i=n.typeName+"xx"+n.methodName+E(8);let o=null;o=n.kind?(...t)=>{const e=window.game||game,i=this.tableName||this.resolveTableName(e.instance.Module.asm);let o=e.instance.Module.asm[i].get(n.tableIndex)(...t);void 0!==o&&(o=new lt(o));const s=t.map((t=>new lt(t)));return n.callback(o,...s),null==o?void 0:o.val()}:(...t)=>{const e=t.map((t=>new lt(t))),i=n.callback(...e);if(void 0===i||!0===i){const e=window.game||game,i=this.tableName||this.resolveTableName(e.instance.Module.asm),o=e.instance.Module.asm[i].get(n.tableIndex);if(n.returnType)return o(...t);o(...t)}},e.a[i]=o;const s=this.internalWasmTypes.findIndex((t=>JSON.stringify(t.params)===JSON.stringify(n.params)&&t.returnType===n.returnType)),u=r.addImportEntry({moduleStr:"a",fieldStr:i,kind:"func",type:s});a.push(u);const l=r.getFunctionIndex(n.index);c.push(l),++f}++u}r.addInstructionParser(16,(t=>{const e=c.map((t=>t.i32())),n=new st(t),i=n.readUint8(),o=n.readVarUint32();if(e.includes(o)){const t=e.indexOf(o),n=this.getHookByIndex(t);return n&&(n.applied=!0),new Uint8Array([i,...$(a[t].i32())])}return t})),r.parse(),WebAssembly.instantiate(r.write(),e).then((t=>{const e=this.getUnappliedHooks(),i=this.tableName||this.resolveTableName(t.instance.exports);e.forEach((e=>{var n=t.instance.exports[i].get(e.tableIndex);const o=e.returnType?[e.returnType]:[];let s=null;s=e.kind?new WebAssembly.Function({parameters:e.params,results:o},((...t)=>{let i=n(...t);void 0!==i&&(i=new lt(i));const o=t.map((t=>new lt(t)));return e.callback(i,...o),null==i?void 0:i.val()})):new WebAssembly.Function({parameters:e.params,results:o},((...t)=>{const i=t.map((t=>new lt(t))),o=e.callback(...i);if(void 0===o||!0===o){if(e.returnType)return n(...t);n(...t)}})),t.instance.exports[i].set(e.tableIndex,s),e.applied=!0})),this.logger.message("Chainloader startup complete"),n(t)}))}))}searchWasmBinary(t){if(!this.globalMetadata)return;const e=function(t,e,n){const i=[],o=new J(t);for(o.seek(8);o.offset<t.byteLength;){const t=o.readULEB128(),e=o.readULEB128();if(11!==t){o.seek(o.offset+e);continue}const n=o.readULEB128();for(let t=0;t<n;t++){const t=o.readULEB128();o.seek(o.offset+1);const e=o.readULEB128();o.seek(o.offset+1);const n=o.readUint8Array(o.readULEB128());i.push({index:t,offset:e,data:n})}break}const s=i[i.length-1],r=s.offset+s.data.length,a=new ArrayBuffer(t.byteLength),c=new J(a),u=new U(a);i.forEach((t=>{u.seek(t.offset),u.writeBytes(t.data)}));const l=function(t,e,n,i,o){const s={offset:0,offsetEnd:i,address:0,addressEnd:i},r={offset:1024,offsetEnd:t,address:1024,addressEnd:t},a={offset:n,offsetEnd:BigInt(0x8000000000000000),address:n,addressEnd:BigInt(0x8000000000000000)},c=new F(e,o);return c.setExecSection(s),c.setDataSection(r),c.setBssSection(a),c}(t.byteLength,a,r,e.methodDefs.length,e.originalImageDefCount),f=function(t,e){return t.seek(e),{reversePInvokeWrapperCount:t.readUint32(),reversePInvokeWrappers:t.readUint32(),genericMethodPointersCount:t.readUint32(),genericMethodPointers:t.readUint32(),genericAdjustorThunks:t.readUint32(),invokerPointersCount:t.readUint32(),invokerPointers:t.readUint32(),unresolvedVirtualCallCount:t.readUint32(),unresolvedVirtualCallPointers:t.readUint32(),interopDataCount:t.readUint32(),interopData:t.readUint32(),windowsRuntimeFactoryCount:t.readUint32(),windowsRuntimeFactoryTable:t.readUint32(),codeGenModulesCount:t.readUint32(),codeGenModules:t.readUint32()}}(c,l.findCodeRegistration()),d=function(t,e,n){t.seek(e);const i=[];for(let e=0;e<n;e++)i.push(t.readUint32());return i}(c,f.codeGenModules,f.codeGenModulesCount),h={},y={};for(let t=0;t<d.length;t++){const e=A(c,d[t]);c.seek(e.moduleName);const i=c.readNullTerminatedUTF8String();if(!(null==n?void 0:n.includes(i)))continue;h[i]=e;const o=P(c,e.methodPointers,e.methodPointerCount);y[i]=o}const p={},B=new J(e.buffer);for(let t=0;t<e.imageDefs.length;t++){let n=e.imageDefs[t],i=x(B,e.header.stringOffset,n.nameIndex),o=n.typeStart+n.typeCount;for(let t=n.typeStart;t<o;t++){let n=e.typeDefs.find((e=>e.typeIndex===t));if(!n)continue;let o=x(B,e.header.stringOffset,n.nameIndex),s=n.methodStart+n.method_count;for(let t=n.methodStart;t<s;t++){let s=e.methodDefs.find((e=>e.methodIndex===t));if(!s)continue;let r=x(B,e.header.stringOffset,s.nameIndex),a=s.token;const c=y[i][(16777215&a)-1],u=x(B,e.header.stringOffset,n.namespaceIndex),l=""===u?o:u+"."+o;if(p[l]||(p[l]={}),void 0!==p[l][r]){const t=p[l][r];delete p[l][r],p[l][r+"_"+t]=t,r=`${r}_${c}`}p[l][r]=c}}}return e.typeDefs.forEach((t=>delete t.typeIndex)),e.methodDefs.forEach((t=>delete t.methodIndex)),w({codeGenModules:h,codeGenModuleMethodPointers:y,scriptData:p})}(t,this.globalMetadata,this.allReferencedAssemblies);e.isErr()?this.logger.error(e.error.print()):this.il2CppContext=e.value}resolveIl2CppFunctions(t){const e=this.internalWasmCode.find((t=>function(t,e){if(t.length<e.length)return!1;for(let n=0;n<e.length;n++)if(t[n]!==e[n])return!1;return!0}(function(t){let e=0;t.forEach((t=>{e+=t.length}));const n=new Uint8Array(e);let i=0;return t.forEach((t=>{n.set(t,i),i+=t.length})),n}(t.instructions),[35,0,65,16,107,34,2,36,0,32,2,32,0,32,1,16])));this.resolvedIl2CppFunctions.il2cpp_string_new=e.preservedIndex+Object.keys(t.a).length}exportIl2CppFunctions(t){for(const e in this.resolvedIl2CppFunctions){const n=t.getFunctionIndex(this.resolvedIl2CppFunctions[e]);t.addExportEntry(n,{fieldStr:e,kind:"func"})}}resolveTableName(t){return Object.keys(t).find((e=>"Table"==t[e].constructor.name))||"Unknown"}createMstr(t){const e=window.game||game,n=e.instance.Module._malloc(t.length);return S(e.instance.Module.HEAPU8,(new TextEncoder).encode(t),n),e.instance.Module.asm.il2cpp_string_new(n,t.length)}malloc(t){return(window.game||game).instance.Module._malloc(t)}free(t){(window.game||game).instance.Module._free(t instanceof lt?t.val():t)}getTableIndex(t,e){var n;if(!(null===(n=this.il2CppContext)||void 0===n?void 0:n.scriptData[t]))return-1;return this.il2CppContext.scriptData[t][e]||-1}getInternalIndex(t){return this.internalMappings[0].elements[t-1]}getHookByIndex(t){let e=0;for(const n of this.plugins){const i=n.hooks.length;if(t<e+i){const i=t-e;return n.hooks[i]}e+=i}return null}getUnappliedHooks(){return this.plugins.flatMap((t=>t.hooks)).filter((t=>!t.applied))}},dt="1.0.0";window.UnityWebModkit=n})();